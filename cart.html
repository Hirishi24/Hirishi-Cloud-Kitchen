<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart | Hirishi Cloud Kitchen</title>
  <link rel="stylesheet" href="index.css">
  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="32x32" href="img/hirishi-logo.png">
  <link rel="icon" type="image/png" sizes="16x16" href="img/hirishi-logo.png">
  <link rel="apple-touch-icon" href="img/hirishi-logo.png">
  <link rel="shortcut icon" href="img/hirishi-logo.png" type="image/x-icon">
  <style>
    /* Add these styles to your existing CSS */
    .logo-link {
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.5em;
      transition: transform 0.3s ease;
    }

    .logo-link:hover {
      transform: scale(1.02);
    }

    .navbar-logo {
      display: flex;
      align-items: center;
    }

    body {
      margin: 0;
      padding: 0;
      overflow-x: hidden;
      width: 100%;
      position: relative;
    }

    .navbar {
      background: rgba(27, 60, 61, 0.95);
      padding: 15px 40px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 1000;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .navbar-logo {
      display: flex;
      align-items: center;
    }

    .logo-link {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: inherit;
    }

    .logo-img {
      height: 40px;
      margin-right: 10px;
    }

    .navbar-title {
      display: flex;
      flex-direction: column;
    }

    .brand-main {
      font-size: 1.5em;
      font-weight: bold;
      color: #fff;
    }

    .brand-sub {
      font-size: 0.9em;
      color: #e3d18a;
    }

    .navbar-links {
      display: flex;
      gap: 30px;
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .navbar-links a {
      color: #fff;
      text-decoration: none;
      font-size: 1.1em;
      transition: color 0.3s ease;
    }

    .navbar-links a:hover {
      color: #e3d18a;
    }

    .nav-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .login-btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: #e3d18a;
      color: #1b3c3d;
      text-decoration: none;
      border-radius: 20px;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .login-btn:hover {
      background: #fff;
      transform: translateY(-2px);
    }

    .cart-icon-link {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
    }

    .cart-icon-svg {
      width: 32px;
      height: 32px;
      filter: brightness(0) invert(1); /* Makes the cart icon white */
      transition: transform 0.3s ease;
    }

    .cart-icon-link:hover .cart-icon-svg {
      transform: scale(1.1);
    }

    .cart-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #e3d18a;
      color: #1b3c3d;
      font-size: 0.8em;
      font-weight: bold;
      min-width: 20px;
      height: 20px;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 6px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .cart-section {
      min-height: 100vh;
      background: linear-gradient(135deg, rgba(27, 60, 61, 0.95), rgba(32, 64, 59, 0.95));
      padding: 120px 20px 80px;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      box-sizing: border-box;
    }

    .cart-container {
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
      padding: 20px;
      box-sizing: border-box;
    }

    .cart-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 20px;
      box-sizing: border-box;
    }

    @media (max-width: 768px) {
      .navbar {
        padding: 15px 20px;
      }

      .navbar-links {
        gap: 15px;
      }

      .nav-right {
        gap: 10px;
      }

      .login-btn {
        padding: 6px 12px;
        font-size: 0.9em;
      }

      .cart-icon-svg {
        width: 28px;
        height: 28px;
      }

      .cart-item {
        flex-direction: column;
        text-align: center;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="navbar-logo">
      <a href="index.html" class="logo-link">
        <img src="img/hirishi-logo.svg" alt="Hirishi Cloud Kitchen Logo" class="logo-img">
        <div class="navbar-title">
          <span class="brand-main">Hirishi</span>
          <span class="brand-sub">Cloud Kitchen</span>
        </div>
      </a>
    </div>
    <ul class="navbar-links">
      <li><a href="index.html#hero">Home</a></li>
      <li><a href="about-mother.html">About</a></li>
      <li><a href="index.html#menu">Menu</a></li>
      <li><a href="pickle-cloud.html">Pickles</a></li>
      <li><a href="index.html#contact">Contact</a></li>
    </ul>
    <div class="nav-right">
      <a href="login.html" class="login-btn">
        <span class="btn-text">Login</span>
        <span class="btn-icon">‚Üí</span>
      </a>
      <a href="cart.html" class="cart-icon-link">
        <span id="cart-badge" class="cart-badge">0</span>
        <img src="img/cart.png" alt="Cart" class="cart-icon-svg">
      </a>
    </div>
  </nav>
  <section class="menu-section">
    <h2 class="menu-title">Your Cart</h2>
    <div id="cart-list" class="menu-grid" style="flex-direction:column;align-items:center;"></div>
    <div id="cart-total" style="text-align:center;font-size:1.3em;margin:1.5em 0;color:#e3d18a;"></div>
    <div style="text-align:center;margin-bottom:1em;">
      <button class="clear-cart-btn" onclick="showClearCartModal()">Clear Cart</button>
    </div>
    <div class="coupon-area">
      <button class="coupon-reveal-btn" onclick="showCouponModal()">Have a coupon code?</button>
    </div>
    <div style="text-align:center;margin-bottom:1.5em;">
      <button class="buy-now-btn" onclick="buyNow()">Buy Now</button>
    </div>
    <div style="text-align:center;margin-bottom:2em;">
      <a href="pickles.html" class="hero-cta">Continue Shopping</a>
    </div>
  </section>
  <div id="buy-modal" class="buy-modal">
    <div class="cloud-shape">
      <button class="close-modal" onclick="closeBuyModal()">&times;</button>
      <div class="panda-area">
        <svg width="90" height="90" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Panda face -->
          <ellipse cx="45" cy="55" rx="22" ry="20" fill="#fff" stroke="#20403b" stroke-width="2"/>
          <!-- Panda ears -->
          <ellipse cx="25" cy="40" rx="7" ry="8" fill="#20403b"/>
          <ellipse cx="65" cy="40" rx="7" ry="8" fill="#20403b"/>
          <!-- Panda eyes -->
          <ellipse cx="37" cy="58" rx="4" ry="5" fill="#20403b"/>
          <ellipse cx="53" cy="58" rx="4" ry="5" fill="#20403b"/>
          <ellipse cx="37" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
          <ellipse cx="53" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
          <!-- Panda nose -->
          <ellipse cx="45" cy="65" rx="2.2" ry="1.2" fill="#20403b"/>
          <!-- Panda smile -->
          <path d="M42 68 Q45 70 48 68" stroke="#20403b" stroke-width="1.5" fill="none"/>
          <!-- Panda board (WhatsApp) -->
          <rect x="25" y="75" width="40" height="18" rx="5" fill="#e3d18a" stroke="#20403b" stroke-width="2"/>
          <text x="45" y="87" text-anchor="middle" font-size="10" fill="#20403b" font-family="'Big Shoulders Text', cursive"> <a href='https://wa.me/919573969154' target='_blank'>WhatsApp</a> </text>
        </svg>
        <a href="https://wa.me/919573969154" target="_blank" class="panda-board-link">Order on WhatsApp</a>
      </div>
      <div class="cloud-message">
        <span>Online checkout coming soon <span style="font-size:1.2em;">üòî</span></span>
      </div>
    </div>
  </div>
  <div id="coupon-modal" class="buy-modal">
    <div class="cloud-shape">
      <button class="close-modal" onclick="closeCouponModal()">&times;</button>
      <div class="panda-coupon-area">
        <div id="panda-runner" class="panda-runner">
          <!-- Running Panda SVG -->
          <svg width="90" height="90" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="45" cy="55" rx="22" ry="20" fill="#fff" stroke="#1b3c3d" stroke-width="2"/>
            <ellipse cx="25" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
            <ellipse cx="65" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
            <ellipse cx="37" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
            <ellipse cx="53" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
            <ellipse cx="37" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
            <ellipse cx="53" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
            <ellipse cx="45" cy="65" rx="2.2" ry="1.2" fill="#1b3c3d"/>
            <path d="M42 68 Q45 70 48 68" stroke="#1b3c3d" stroke-width="1.5" fill="none"/>
            <!-- Panda hand holding box -->
            <rect x="30" y="75" width="30" height="14" rx="4" fill="#e3d18a" stroke="#1b3c3d" stroke-width="2"/>
          </svg>
        </div>
        <div id="coupon-box-area" class="coupon-box-area">
          <input type="text" id="coupon-modal-input" class="coupon-input" placeholder="Type your coupon code...">
          <button class="apply-coupon-btn" onclick="applyCoupon()">Apply</button>
        </div>
      </div>
      <div class="cloud-message" id="coupon-modal-message"></div>
      <div id="confetti" class="confetti"></div>
    </div>
  </div>
  <div id="clear-cart-modal" class="buy-modal">
    <div class="cloud-shape">
      <button class="close-modal" onclick="closeClearCartModal()">&times;</button>
      <div class="panda-clear-area">
        <svg width="90" height="90" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg" class="panda-wave">
          <ellipse cx="45" cy="55" rx="22" ry="20" fill="#fff" stroke="#1b3c3d" stroke-width="2"/>
          <ellipse cx="25" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
          <ellipse cx="65" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
          <ellipse cx="37" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
          <ellipse cx="53" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
          <ellipse cx="37" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
          <ellipse cx="53" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
          <ellipse cx="45" cy="65" rx="2.2" ry="1.2" fill="#1b3c3d"/>
          <path d="M42 68 Q45 70 48 68" stroke="#1b3c3d" stroke-width="1.5" fill="none"/>
          <!-- Panda waving hand -->
          <ellipse class="panda-hand" cx="65" cy="70" rx="5" ry="2.5" fill="#1b3c3d"/>
        </svg>
        <div class="cloud-message">Cart cleared! Panda says bye! üëã</div>
      </div>
    </div>
  </div>
  <footer class="footer">
    <div class="footer-content">
      <span>&copy; 2025 Hirishi Cloud Kitchen. All rights reserved.</span>
      <span class="footer-socials">
        <a href="https://twitter.com/hirishicloudkitchen" target="_blank"><img src="img/twitter-icon.png" alt="Twitter"></a>
        <a href="https://youtube.com/@hirishicloudkitchen" target="_blank"><img src="img/Youtube logo.webp" alt="YouTube"></a>
        <a href="https://whatsapp.com/channel/0029VaFQ9gFJt1bQ7n3QyM2A" target="_blank"><img src="img/whatsapp-channel-icon.jpg" alt="WhatsApp Channel"></a>
        <a href="https://instagram.com/hirishicloudkitchen" target="_blank"><img src="img/instagram-icon.png" alt="Instagram"></a>
        <a href="https://wa.me/919398299067" target="_blank"><img src="img/whatsapp-icon.png" alt="WhatsApp"></a>
      </span>
    </div>
  </footer>
  <script src="js/products.js"></script>
  <script src="js/cart.js"></script>
  <script src="js/alerts.js"></script>
  <script>
    // Wait for products.js to load
    document.addEventListener('DOMContentLoaded', function() {
      // Initial render
      renderCart();
      
      // Update cart badge
      updateCartBadge();
    });

    function renderCart() {
      const cart = JSON.parse(localStorage.getItem('cart') || '{}');
      const cartList = document.getElementById('cart-list');
      let total = 0;
      let html = '';
      
      Object.keys(cart).forEach(id => {
        const item = cart[id];
        const qty = item.qty;
        const itemTotal = item.price * qty;
        total += itemTotal;
        
        // Extract base id for image (before dash)
        const baseId = id.split('-')[0];
        
        // Find the product in products.js to get the correct image path
        let imgSrc = '';
        if (window.products && window.products.pickles) {
          const product = window.products.pickles.find(p => p.id === baseId);
          if (product) {
            imgSrc = `img/${product.image}`;
            console.log('Found product image:', imgSrc, 'for product:', product.name);
          } else {
            console.log('Product not found for ID:', baseId);
            // Try to find a matching product by name
            const productByName = window.products.pickles.find(p => item.name.includes(p.name));
            if (productByName) {
              imgSrc = `img/${productByName.image}`;
              console.log('Found product by name:', imgSrc, 'for product:', productByName.name);
            }
          }
        }
        
        html += `
          <div class="menu-item" style="width:340px;flex-direction:row;align-items:center;justify-content:space-between;gap:1em;">
            <div style="display:flex;flex-direction:column;align-items:center;">
              <img src="${imgSrc}" alt="${item.name}" style="width:80px;height:80px;border-radius:50%;border:2px solid #e3d18a;background:#fffbe6;object-fit:cover;">
              <svg width="38" height="38" viewBox="0 0 90 90" style="margin-top:-8px;" fill="none" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="45" cy="55" rx="16" ry="14" fill="#fff" stroke="#1b3c3d" stroke-width="2"/>
                <ellipse cx="30" cy="44" rx="5" ry="6" fill="#1b3c3d"/>
                <ellipse cx="60" cy="44" rx="5" ry="6" fill="#1b3c3d"/>
                <ellipse cx="40" cy="58" rx="2.2" ry="2.5" fill="#1b3c3d"/>
                <ellipse cx="50" cy="58" rx="2.2" ry="2.5" fill="#1b3c3d"/>
                <ellipse cx="40" cy="59" rx="0.7" ry="1" fill="#fff"/>
                <ellipse cx="50" cy="59" rx="0.7" ry="1" fill="#fff"/>
                <ellipse cx="45" cy="65" rx="1.2" ry="0.7" fill="#1b3c3d"/>
                <path d="M42 68 Q45 70 48 68" stroke="#1b3c3d" stroke-width="1.2" fill="none"/>
              </svg>
              <div style="font-family:'Big Shoulders Text', cursive;font-size:0.95em;color:#1b3c3d;background:#e3d18a;border-radius:8px;padding:0.1em 0.5em;margin-top:2px;">Take it to your home!</div>
            </div>
            <div style="flex:1;text-align:left;">
              <div style="font-family:'Big Shoulders Text', cursive;font-weight:700;font-size:1.1em;">${item.name}</div>
              <div style="font-family:'Big Shoulders Text', cursive;font-size:1em;">‚Çπ${item.price} x ${qty} = <b>‚Çπ${itemTotal}</b></div>
            </div>
            <div style="display:flex;flex-direction:column;align-items:center;gap:0.3em;">
              <button onclick="updateQty('${id}', 1)" style="width:28px;height:28px;font-family:'Big Shoulders Text', cursive;">+</button>
              <span style="font-family:'Big Shoulders Text', cursive;">${qty}</span>
              <button onclick="updateQty('${id}', -1)" style="width:28px;height:28px;font-family:'Big Shoulders Text', cursive;">-</button>
              <button onclick="removeItem('${id}')" style="margin-top:0.5em;color:#b00;background:none;border:none;font-family:'Big Shoulders Text', cursive;">Remove</button>
            </div>
          </div>
        `;
      });
      
      cartList.innerHTML = html || '<div style="color:#fffbe6;font-size:1.2em;">Your cart is empty.</div>';
      document.getElementById('cart-total').innerHTML = total ? `Grand Total: <b>‚Çπ${total}</b>` : '';
    }
    function updateQty(id, delta) {
      const cart = JSON.parse(localStorage.getItem('cart') || '{}');
      if (!cart[id]) return;
      cart[id].qty += delta;
      if (cart[id].qty <= 0) delete cart[id];
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }
    function removeItem(id) {
      const cart = JSON.parse(localStorage.getItem('cart') || '{}');
      delete cart[id];
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }
    let couponApplied = false;
    let couponDiscount = 0;
    renderCart();
    // Cart badge update
    function updateCartBadge() {
      const cart = JSON.parse(localStorage.getItem('cart') || '{}');
      let count = 0;
      Object.values(cart).forEach(item => {
        count += item.qty;
      });
      document.getElementById('cart-badge').textContent = count;
    }
    updateCartBadge();
    window.addEventListener('storage', updateCartBadge);
    window.addEventListener('pageshow', updateCartBadge);
    // Buy Now button action
    function buyNow() {
      document.getElementById('buy-modal').classList.add('show');
    }
    function closeBuyModal() {
      document.getElementById('buy-modal').classList.remove('show');
    }
    // Coupon modal logic
    function showCouponModal() {
      document.getElementById('coupon-modal').classList.add('show');
      document.getElementById('coupon-modal-message').textContent = '';
      document.getElementById('coupon-modal-input').value = '';
      document.getElementById('panda-runner').classList.remove('panda-jump');
      document.getElementById('confetti').innerHTML = '';
      document.getElementById('panda-runner').classList.add('panda-run');
      setTimeout(() => {
        document.getElementById('panda-runner').classList.remove('panda-run');
      }, 900);
    }
    function closeCouponModal() {
      document.getElementById('coupon-modal').classList.remove('show');
    }
    function applyCoupon() {
      const code = document.getElementById('coupon-modal-input').value.trim();
      const cart = JSON.parse(localStorage.getItem('cart') || '{}');
      let total = 0;
      Object.values(cart).forEach(item => {
        total += item.price * item.qty;
      });

      // Check for exclamation mark in the code
      if (code.includes('!')) {
        document.getElementById('coupon-modal-message').textContent = 'Hey! Please remove the exclamation mark ( ! ) from the code. Just use HIRISHI10 or RappaRappa50 üòä';
        return;
      }

      if (code.toLowerCase() === 'hirishi10' && total > 2000) {
        couponApplied = true;
        couponDiscount = Math.round(total * 0.10);
        document.getElementById('coupon-modal-message').textContent = 'üéâ Coupon applied! 10% off';
        // Panda jumps and confetti
        document.getElementById('panda-runner').classList.add('panda-jump');
        showConfetti();
        setTimeout(() => {
          closeCouponModal();
          renderCart();
        }, 1800);
      } else if (code.toLowerCase() === 'rapparappa50' && total >= 1000) {
        couponApplied = true;
        couponDiscount = 50;
        document.getElementById('coupon-modal-message').textContent = 'üéâ Coupon applied! ‚Çπ50 off';
        // Panda jumps and confetti
        document.getElementById('panda-runner').classList.add('panda-jump');
        showConfetti();
        setTimeout(() => {
          closeCouponModal();
          renderCart();
        }, 1800);
      } else if (code.toLowerCase() === 'hirishi10') {
        document.getElementById('coupon-modal-message').textContent = '‚ùå Add more items to reach ‚Çπ2000 for this coupon!';
      } else if (code.toLowerCase() === 'rapparappa50') {
        document.getElementById('coupon-modal-message').textContent = '‚ùå Add more items to reach ‚Çπ1000 for this coupon!';
      } else {
        document.getElementById('coupon-modal-message').textContent = '‚ùå Invalid coupon. Try HIRISHI10 or RappaRappa50!';
      }
    }
    function showConfetti() {
      const confetti = document.getElementById('confetti');
      confetti.innerHTML = '';
      for (let i = 0; i < 24; i++) {
        const el = document.createElement('div');
        el.className = 'confetti-piece';
        el.style.left = (Math.random() * 90 + 5) + '%';
        el.style.background = ['#e3d18a','#fffbe6','#1b3c3d','#f7c873'][i%4];
        el.style.animationDelay = (Math.random() * 0.5) + 's';
        confetti.appendChild(el);
      }
    }
    // Patch renderCart to show discount if coupon applied
    const origRenderCart = renderCart;
    let couponTimer = null;
    let couponExpireTime = null;
    renderCart = function() {
      origRenderCart();
      const totalDiv = document.getElementById('cart-total');
      if (couponApplied && couponDiscount > 0) {
        const totalText = totalDiv.innerHTML.match(/Grand Total: <b style='color:#e3d18a;'>‚Çπ(\d+)<\/b>/) || totalDiv.innerHTML.match(/Grand Total: <b>‚Çπ(\d+)<\/b>/);
        if (totalText) {
          const oldTotal = parseInt(totalText[1]);
          const newTotal = oldTotal - couponDiscount;
          totalDiv.innerHTML = `
            <div class='total-anim-wrap'>
              <span class='old-total-anim'>‚Çπ${oldTotal}</span>
              <span class='new-total-anim'>‚Çπ${newTotal}</span>
              <span class='savings-anim'>(You saved ‚Çπ${couponDiscount}!)</span>
            </div>
            <div id='coupon-timer-box' class='coupon-timer-box'></div>
          `;
          setTimeout(() => {
            document.querySelector('.new-total-anim').classList.add('show-new-total');
            document.querySelector('.savings-anim').classList.add('show-savings');
          }, 100);
          // Start or update timer
          if (!couponExpireTime) {
            couponExpireTime = Date.now() + 10 * 60 * 1000;
            localStorage.setItem('hirishi_coupon_expire', couponExpireTime);
          }
          startCouponTimer();
        }
      } else {
        // Remove timer if coupon not applied
        if (couponTimer) clearInterval(couponTimer);
        couponExpireTime = null;
        localStorage.removeItem('hirishi_coupon_expire');
        const timerBox = document.getElementById('coupon-timer-box');
        if (timerBox) timerBox.innerHTML = '';
      }
    }
    function startCouponTimer() {
      if (couponTimer) clearInterval(couponTimer);
      couponTimer = setInterval(() => {
        const timerBox = document.getElementById('coupon-timer-box');
        if (!timerBox) return;
        const now = Date.now();
        const expire = parseInt(localStorage.getItem('hirishi_coupon_expire'));
        let left = Math.max(0, Math.floor((expire - now) / 1000));
        let min = Math.floor(left / 60);
        let sec = left % 60;
        timerBox.innerHTML = `<div class='timer-anim'><b>Coupon active!</b> Use within <span class='timer-count'>${min}:${sec.toString().padStart(2, '0')}</span> minutes to checkout.</div>`;
        if (left <= 0) {
          clearInterval(couponTimer);
          couponApplied = false;
          couponDiscount = 0;
          couponExpireTime = null;
          localStorage.removeItem('hirishi_coupon_expire');
          timerBox.innerHTML = `<div class='timer-expired-anim'>Oops, you have lost your coupon! <span class='timer-emoji'>üò¢</span></div>`;
          setTimeout(() => { renderCart(); }, 2500);
        }
      }, 1000);
    }
    // On page load, restore coupon timer if present
    if (localStorage.getItem('hirishi_coupon_expire')) {
      const expire = parseInt(localStorage.getItem('hirishi_coupon_expire'));
      if (expire > Date.now()) {
        couponApplied = true;
        couponExpireTime = expire;
        startCouponTimer();
      } else {
        localStorage.removeItem('hirishi_coupon_expire');
      }
    }
    function showClearCartModal() {
      const cart = JSON.parse(localStorage.getItem('cart') || '{}');
      const hasItems = Object.keys(cart).length > 0;
      const modal = document.getElementById('clear-cart-modal');
      const pandaArea = modal.querySelector('.panda-clear-area');
      if (hasItems) {
        pandaArea.innerHTML = `
          <svg width="90" height="90" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg" class="panda-wave">
            <ellipse cx="45" cy="55" rx="22" ry="20" fill="#fff" stroke="#1b3c3d" stroke-width="2"/>
            <ellipse cx="25" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
            <ellipse cx="65" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
            <ellipse cx="37" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
            <ellipse cx="53" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
            <ellipse cx="37" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
            <ellipse cx="53" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
            <ellipse cx="45" cy="65" rx="2.2" ry="1.2" fill="#1b3c3d"/>
            <path d="M42 68 Q45 70 48 68" stroke="#1b3c3d" stroke-width="1.5" fill="none"/>
            <!-- Panda waving hand -->
            <ellipse class="panda-hand" cx="65" cy="70" rx="5" ry="2.5" fill="#1b3c3d"/>
          </svg>
          <div class="cloud-message">Cart cleared! Panda says bye! üëã</div>
        `;
        modal.classList.add('show');
        setTimeout(() => {
          document.querySelector('.panda-hand').classList.add('wave-hand');
        }, 200);
        setTimeout(() => {
          clearCart();
          closeClearCartModal();
        }, 1800);
      } else {
        pandaArea.innerHTML = `
          <svg width="90" height="90" viewBox="0 0 90 90" fill="none" xmlns="http://www.w3.org/2000/svg" class="panda-relax">
            <ellipse cx="45" cy="55" rx="22" ry="20" fill="#fff" stroke="#1b3c3d" stroke-width="2"/>
            <ellipse cx="25" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
            <ellipse cx="65" cy="40" rx="7" ry="8" fill="#1b3c3d"/>
            <ellipse cx="37" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
            <ellipse cx="53" cy="58" rx="4" ry="5" fill="#1b3c3d"/>
            <ellipse cx="37" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
            <ellipse cx="53" cy="60" rx="1.2" ry="1.5" fill="#fff"/>
            <ellipse cx="45" cy="65" rx="2.2" ry="1.2" fill="#1b3c3d"/>
            <path d="M40 70 Q45 75 50 70" stroke="#1b3c3d" stroke-width="1.5" fill="none"/>
            <!-- Panda relaxed hand -->
            <ellipse cx="65" cy="75" rx="5" ry="2.5" fill="#1b3c3d"/>
          </svg>
          <div class="cloud-message">Hey bro, your cart is already clear! üí§</div>
        `;
        modal.classList.add('show');
        setTimeout(() => { closeClearCartModal(); }, 1800);
      }
    }
    function closeClearCartModal() {
      document.getElementById('clear-cart-modal').classList.remove('show');
      const hand = document.querySelector('.panda-hand');
      if (hand) hand.classList.remove('wave-hand');
    }
    function clearCart() {
      localStorage.removeItem('cart');
      couponApplied = false;
      couponDiscount = 0;
      couponExpireTime = null;
      localStorage.removeItem('hirishi_coupon_expire');
      renderCart();
      updateCartBadge();
    }
    document.addEventListener('DOMContentLoaded', function() {
      const removeButtons = document.querySelectorAll('.remove-item');
      const clearCartButton = document.querySelector('.clear-cart');
      const applyCouponButton = document.querySelector('.apply-coupon');
      
      removeButtons.forEach(button => {
        button.addEventListener('click', function() {
          const productId = this.dataset.productId;
          removeFromCart(productId);
          showAlert('removeFromCart');
        });
      });
      
      clearCartButton.addEventListener('click', function() {
        clearCart();
        showAlert('clearCart');
      });
      
      applyCouponButton.addEventListener('click', function() {
        const couponCode = document.querySelector('.coupon-input').value;
        if (applyCoupon(couponCode)) {
          showAlert('couponApplied');
        } else {
          showAlert('couponExpired');
        }
      });
    });
  </script>
</body>
</html> 